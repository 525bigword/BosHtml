<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<title>收派标准</title>
		<link rel="stylesheet" type="text/css" href="../../layui/css/layui.css">
	</head>
	<body>
		<form class="layui-form">
			<table class="layui-table" style="width: 98%;margin: 1px auto;text-align: center;">
				<tbody>
					<tr>
						<td class="layui-bg-gray" width="15%">标准名称</td>
						<td width="35%" id="name">
						</td>
						<td class="layui-bg-gray" width="15%">作废标志</td>
						<td width="35%">
							<input type="radio" name="del" value="1" title="是">
							<input type="radio" name="del" value="0" title="否" checked>

						</td>
					</tr>
					<tr>
						<td class="layui-bg-gray">最小重量</td>
						<td>
							<input type="number" id="minWeight" maxlength="100000000000000" name="title" placeholder="请输入最小重量" autocomplete="off"
							 class="layui-input">
						</td>
						<td class="layui-bg-gray">最大重量</td>
						<td>
							<input type="number" maxlength="100000000000000" id="maxWeight" name="title" placeholder="请输入最大重量" autocomplete="off"
							 class="layui-input">
						</td>
					</tr>
					<tr>
						<td class="layui-bg-gray">操作人员</td>
						<td>张三</td>
						<td class="layui-bg-gray">操作单位</td>
						<td>总公司</td>
					</tr>
					<tr>
						<td class="layui-bg-gray">操作时间</td>
						<td id="operationTime"></td>
						<td class="layui-bg-gray"></td>
						<td> </td>
					</tr>
					<tr>
						<td colspan="4">
							<button class="layui-btn " id="add" style="background: #1da02b;" type="button">确定</button>
							<button type="button" id="quxiao" name="quxiao" class="layui-btn layui-btn-primary">取消</button>
						</td>
					</tr>
				</tbody>
			</table>
		</form>
		<script type="text/javascript" src="../../custom/jquery.min.js"></script>
		<script type="text/javascript" src="../../layui/layui.js"></script>
		<script type="text/text/javascript" src="../js/bos.js"></script>
		<script type="text/text/javascript" src="../js/jquery.cookie.js"></script>
		<script type="text/javascript">
				
			$(function() {
					$.ajaxSetup({
						dataType: "json",
						cache: false,
						headers: {
							"Authorization": 'bos'+$.cookie('user')
						},
						xhrFields: {
							withCredentials: true
						} /* ,
						complete: function(xhr) {
							//token过期，则跳转到登录页面
							if(xhr.responseJSON.code == 401){
								parent.location.href = baseURL + 'login.html';
							}
						} */
					}); 
				$.ajax({
					url: url + 'jurisdiction/parsetoken',
					type: 'post',
					header:{
						"Authorization": 'bos'+$.cookie('user')
					},
					async: false,
					dateType: 'json',
					success: function(data) {
						console.log(data);
					}
				});
				getDate();
				setInterval(getDate, 1000);
				$('#minWeight').keyup(function() {
					$("#name").text($("#minWeight").val() + "-" + $("#maxWeight").val() + "公斤");
				});
				$('#maxWeight').keyup(function() {
					$("#name").text($("#minWeight").val() + "-" + $("#maxWeight").val() + "公斤");
				});
				$("#quxiao").click(function() {
					var index = parent.layer.getFrameIndex(window.name);
					parent.layer.close(index);
				})
				$("#add").click(function() {
					var name = $("#name").text();
					var minWeight = $("#minWeight").val();
					var maxWeight = $("#maxWeight").val();
					if (minWeight == null || maxWeight == null || minWeight == "" || maxWeight == "") {
						layer.msg('请将信息补充完整', {
							icon: 5,
							time: 800
						});
						return;
					}
					if (minWeight < 0) {
						layer.msg('最小重量不能为负值', {
							icon: 5,
							time: 800
						});
						return;
					}
					if (maxWeight < 0) {
						layer.msg('最大重量不能为负值', {
							icon: 5,
							time: 800
						});
						return;
					}
					if (maxWeight - minWeight < 0) {
						layer.msg('最大重量不能小于最小重量', {
							icon: 5,
							time: 1000
						});
						return;
					}
					/* $.ajax({
						url: url+'basDeliveryStandard/saveBasDeliveryStandard',
						type: 'post',
						async: false,
						data: {
							"name":name,
							"maxWeight": maxWeight,
							"minWeight": minWeight,
							"basicFileNumber":basicFileNumber
						},
						success: function(data) {
							if(data==1){
								layer.msg('收派标准名称已存在', {
									icon: 5,
									time: 1000
								});
							}else{
								var index = parent.layer.getFrameIndex(window.name);
								parent.layer.close(index);
							}
						}
					}); */
				})
			})

			function twoDigits(val) {
				if (val < 10) return "0" + val;
				return val;
			}

			function getDate() {
				var today = new Date();
				var date = today.getFullYear() + "-" + twoDigits(today.getMonth() + 1) + "-" + twoDigits(today.getDate()) + " ";
				var time = twoDigits(today.getHours()) + ": " + twoDigits(today.getMinutes()) + ": " + twoDigits(today.getSeconds());
				$("#operationTime").text(date + " " + time);
			}
			layui.use('form', function() {

			});
		</script>
	</body>
</html>
